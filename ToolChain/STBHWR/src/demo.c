#include <stdio.h>
#include <stdlib.h>
//#include <curses.h>
#include <locale.h>
#include "WWHW.h"

#ifdef __cplusplus
extern "C"{
#endif


extern const unsigned long arrayHwdataR[];


// memset
void * ww_memset (void *dst, int val, unsigned int count)
{
        void *start = dst;

#if defined (_M_MRX000) || defined (_M_ALPHA) || defined (_M_PPC)
        {
        extern void RtlFillMemory( void *, size_t count, char );

        RtlFillMemory( dst, count, (char)val );
        }
#else  /* defined (_M_MRX000) || defined (_M_ALPHA) || defined (_M_PPC) */
        while (count--) {
                *(char *)dst = (char)val;
                dst = (char *)dst + 1;
        }
#endif  /* defined (_M_MRX000) || defined (_M_ALPHA) || defined (_M_PPC) */

        return(start);
}



////////////////////////////////////////////////////////////////
// 初始化引擎
////////////////////////////////////////////////////////////////
int InitEngine()
{
    
    //wprintf(L"unsigned long = %d\n", sizeof(unsigned long));
    //wprintf(L"unsigned int = %d\n", sizeof(unsigned int));
    //wprintf(L"unsigned short = %d\n", sizeof(unsigned short));
    //wprintf(L"wchar_t = %d\n", sizeof(wchar_t));

    int r = WWInitRecognition(arrayHwdataR, 0);
    //wprintf(L"init = %d\n", r);
    return r;
}


////////////////////////////////////////////////////////////////
// 执行识别
////////////////////////////////////////////////////////////////
void DoRegconize()
{
    int i = 0;
	unsigned short result[32];
    short strokeAry[] = {               /* 这是笔迹数据，每个笔画的结束用 （-1，-1）或 （-1，0）表示，整个字结束用 （-1,-1） **/
/*
// 好
        248, 160, 249, 172, 255, 190, 261, 205, 271, 217, 280, 227, 290, 236, 297, 241, 302, 246, 307, 248, 308, 249, 308, 249, -1, 0, 
        297, 143, 296, 143, 294, 148, 291, 159, 288, 172, 283, 187, 277, 202, 271, 217, 265, 228, 260, 235, 255, 241, 252, 244, 251, 244, 250, 244, 249, 244, 249, 244, -1, 0, 
        218, 198, 222, 196, 227, 193, 238, 190, 249, 185, 266, 180, 279, 177, 289, 175, 299, 174, 304, 174, 307, 174, 308, 174, 308, 174, -1, 0,
        308, 166, 315, 163, 325, 161, 336, 161, 344, 161, 351, 161, 352, 161, 352, 162, 352, 164, 348, 171, 344, 179, 338, 190, 336, 201, 335, 209, 335, 215, 335, 222, 337, 228, 337, 231, 338, 233, 338, 236, 338, 238, 336, 241, 334, 243, 332, 244, 329, 244, 325, 245, 323, 245, 322, 245, 319, 245, 316, 245, 312, 245, 306, 245, 306, 245, -1, 0, 
        293, 207, 298, 205, 305, 205, 318, 205, 338, 205, 368, 205, 390, 205, 406, 205, 416, 203, 416, 203, -1, 0, 
*/

/*   
//      
// 大
        222, 187, 226, 187, 234, 187, 248, 187, 270, 187, 300, 187, 325, 187, 349, 187, 363, 187, 376, 187, 383, 187, 388, 187, 390, 187, 390, 187, -1, 0, 
        311, 140, 310, 148, 308, 159, 304, 170, 301, 183, 296, 196, 289, 210, 285, 221, 280, 237, 276, 244, 274, 248, 271, 251, 271, 252, 269, 252, 268, 252, 265, 252, 265, 252, -1, 0, 
        311, 208, 313, 208, 317, 212, 324, 218, 332, 224, 346, 229, 357, 236, 373, 242, 384, 245, 392, 248, 399, 248, 399, 248, -1, 0, 
*/

///*
// 谢
        318, 143, 317, 143, 317, 144, 317, 149, 317, 151, 317, 154, 317, 156, 317, 158, 317, 158, -1, 0, 
        292, 186, 292, 188, 293, 188, 302, 189, 312, 191, 316, 191, 319, 191, 319, 193, 315, 196, 306, 203, 300, 209, 295, 214, 288, 220, 285, 225, 283, 228, 283, 232, 283, 234, 283, 237, 283, 239, 283, 240, 286, 240, 291, 240, 300, 236, 315, 229, 328, 220, 328, 220, -1, 0, 
        360, 149, 357, 153, 350, 162, 343, 171, 338, 179, 333, 188, 332, 191, 331, 195, 331, 198, 331, 199, 331, 200, 332, 200, 333, 200, 333, 201, 333, 207, 333, 212, 333, 219, 331, 221, 330, 224, 330, 225, 329, 226, 329, 225, 330, 222, 332, 218, 337, 209, 340, 202, 343, 195, 347, 186, 350, 182, 355, 177, 356, 175, 358, 173, 359, 172, 361, 172, 362, 172, 363, 170, 366, 171, 368, 173, 370, 178, 372, 182, 374, 188, 374, 190, 374, 195, 374, 199, 372, 205, 370, 212, 367, 219, 362, 226, 360, 236, 358, 244, 358, 251, 358, 256, 358, 261, 358, 265, 357, 269, 356, 272, 356, 276, 355, 279, 353, 283, 352, 285, 352, 286, 351, 287, 350, 285, 348, 282, 344, 275, 342, 269, 338, 263, 336, 257, 334, 249, 334, 242, 334, 237, 334, 233, 334, 230, 334, 227, 334, 226, 334, 224, 335, 222, 338, 222, 346, 220, 356, 219, 366, 219, 374, 219, 378, 219, 381, 219, 378, 224, 374, 226, 367, 230, 357, 236, 345, 239, 337, 240, 334, 241, 335, 241, 343, 241, 350, 241, 358, 241, 362, 241, 366, 241, 368, 241, 370, 243, 370, 244, 369, 248, 365, 252, 361, 258, 353, 266, 346, 271, 333, 275, 319, 277, 304, 279, 297, 279, 296, 279, 296, 278, 296, 276, 296, 276, -1, 0, 
        363, 237, 366, 236, 375, 235, 383, 233, 395, 230, 405, 228, 415, 224, 422, 220, 425, 217, 428, 213, 429, 210, 429, 207, 429, 203, 423, 197, 423, 197, -1, 0, 
        402, 155, 407, 157, 411, 163, 412, 168, 414, 176, 416, 187, 417, 199, 418, 208, 419, 216, 421, 226, 421, 234, 421, 242, 421, 251, 418, 261, 414, 271, 411, 278, 407, 284, 403, 289, 401, 292, 396, 294, 394, 296, 392, 296, 389, 296, 388, 296, 383, 292, 383, 292, -1, 0, 
        382, 261, 383, 261, 386, 261, 388, 261, 390, 261, 392, 261, 394, 261, 394, 261, -1, 0, 
//*/
        -1, -1,
    };

    ww_memset(result, 0, sizeof(result));
    WWRecognize(strokeAry, (unsigned short*)result, 10, WWHW_RANGE_GB2312);

    
    setlocale(LC_CTYPE, "");
    for(i = 0; i < 10; i++)
    {       
        //printf("%lc \n",result[i]);
        
        printf("%x \n",result[i]);
    }
    //getch();
}


void main()
{
    InitEngine();
    
    DoRegconize();
}

#ifdef __cplusplus
}
#endif
